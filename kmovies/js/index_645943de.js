!function(e){function t(t){for(var n,i,o=t[0],c=t[1],l=t[2],m=0,p=[];m<o.length;m++)i=o[m],r[i]&&p.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var c=a[o];0!==r[c]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={2:0},s=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/kmovies/";var o=window.leihuoJsonp=window.leihuoJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;s.push(["0imc",0]),a()}({"0Irh":function(e,t,a){},"0imc":function(e,t,a){a("nF/r"),a("UxGy")},"8Id0":function(e,t,a){"use strict";a.d(t,"g",function(){return S}),a.d(t,"f",function(){return N}),a.d(t,"i",function(){return w}),a.d(t,"j",function(){return k}),a.d(t,"h",function(){return C}),a.d(t,"e",function(){return x}),a.d(t,"c",function(){return _}),a.d(t,"a",function(){return I}),a.d(t,"d",function(){return T}),a.d(t,"b",function(){return P});var n=a("cLjf"),r=a.n(n),s=a("hDQ3"),i=a.n(s),o=a("f0Pt"),c=a.n(o),l=a("N+L8");var u,m,p,h,d,f,g,v,b,y,E=c.a.create({baseURL:"//api.chamajiuxi.com",withCredentials:!0}),S=(u=i()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.post("/auth/github",{code:Object(l.b)("code")});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)}),N=(m=i()(r.a.mark(function e(t){var a=t.userName;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/salt",{params:{userName:a}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return m.apply(this,arguments)}),w=(p=i()(r.a.mark(function e(t){var a=t.userName,n=t.hash,s=t.remember,i=t.captcha;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.post("/login",{userName:a,hash:n,remember:s,captcha:i});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return p.apply(this,arguments)}),k=(h=i()(r.a.mark(function e(t){var a=t.userName,n=t.salt,s=t.hash;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.post("/signup",{userName:a,salt:n,hash:s});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return h.apply(this,arguments)}),C=(d=i()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/logout");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return d.apply(this,arguments)}),x=(f=i()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/info");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return f.apply(this,arguments)}),_=(g=i()(r.a.mark(function e(t){var a=t.id;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/torrents",{params:{id:a}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)}),I=(v=i()(r.a.mark(function e(t){var a=t.page,n=t.tag,s=t.search;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/movies",{params:{page:a,tag:n,search:s}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)}),T=(b=i()(r.a.mark(function e(t){var a=t.tag,n=t.search;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/totalcount",{params:{tag:a,search:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return b.apply(this,arguments)}),P=(y=i()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.get("/taglist");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return y.apply(this,arguments)})},C4rp:function(e,t,a){},MvKN:function(e,t,a){},"N+L8":function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"b",function(){return i});var n=a("fus+"),r=a.n(n);function s(e,t){return{salt:(t=t||r.a.lib.WordArray.random(32))+"",hash:r.a.PBKDF2(e,t+"",{keySize:8})+""}}function i(e){return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}},Sy0d:function(e,t,a){e.exports=a.p+"img/avatar_94919438.png"},UxGy:function(e,t,a){"use strict";a.r(t);var n=a("bS4n"),r=a.n(n),s=(a("1NH0"),a("COBe")),i=a.n(s),o=a("Ds8w"),c=a.n(o),l=a("6ato"),u=a.n(l),m=a("2dj7"),p=a.n(m),h=a("Xtzg"),d=a.n(h),f=a("0dFU"),g=a.n(f),v=(a("Z7NK"),a("OJMH")),b=a.n(v),y=(a("yEJC"),a("FOhV")),E=a.n(y),S=a("uqIC"),N=a.n(S),w=(a("R58E"),a("QqW2")),k=a.n(w),C=(a("D4QG"),a("Z4TM")),x=a.n(C),_=a("Asgo"),I=a.n(_),T=(a("re0a"),a("lEAa")),P=a.n(T),j=(a("mmHs"),a("8Id0")),M=(a("Gh01"),a("bgkV")),O=a.n(M),D=(a("6cbs"),a("+Wc2")),L=a.n(D),F=(a("MvKN"),function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.state={downloadList:null},a}return g()(t,e),p()(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.item.id;Object(j.c)({id:t}).then(function(t){var a=t.data,n=a.code,r=a.body;n>0?e.setState({downloadList:r}):-1===n?e.setState({downloadList:null}):e.setState({downloadList:[]})})}},{key:"render",value:function(){var e=this.props,t=e.item,a=e.onDetailClose,n=e.visible,r=this.state.downloadList,s="暂无";t.doubanLink&&(s=N.a.createElement("a",{href:t.doubanLink,target:"_blank"},t.doubanLink));var i=N.a.createElement("div",{className:"info-title"},"种子："),o=null;return o=null===r?N.a.createElement("p",{className:"info-msg"},"请登录后查看"):r&&r.length>0?r.map(function(e,t){return N.a.createElement("p",{className:"movie-download-item",key:t},N.a.createElement("a",{href:e.href,target:"_blank"},e.title))}):N.a.createElement("p",{className:"info-msg"},"该电影暂无资源"),N.a.createElement(O.a,{title:t.title,width:"800",placement:"right",onClose:a,visible:n},N.a.createElement("div",{className:"info-wrap"},N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"豆瓣评分："),N.a.createElement("span",{className:"content"},t.doubanScore,N.a.createElement(L.a,{disabled:!0,value:t.doubanScore/2}))),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"豆瓣链接："),N.a.createElement("span",{className:"content"},s)),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"上映日期："),N.a.createElement("span",{className:"content"},t.releaseDate)),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"大陆上映："),N.a.createElement("span",{className:"content"},t.releaseInChina?"是":"否")),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"分类标签："),N.a.createElement("span",{className:"content"},(t.tags||[]).join(",")))),i,o)}}]),t}(N.a.Component)),V=P.a.Meta,U=function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.handlePageChange=a.handlePageChange.bind(a),a.onDetailClose=a.onDetailClose.bind(a),a.state={movieList:[],totalCount:1,currPage:1,detailVisible:!1,currDetailItem:[],loading:!0},a}return g()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this;I.a.all([this.getMovieCount({tag:this.props.currTag,search:this.props.currSearch}),this.getMovies({page:this.state.currPage,tag:this.props.currTag,search:this.props.currSearch})]).then(function(){e.setState({loading:!1})})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({currPage:1,loading:!0}),I.a.all([this.getMovieCount({tag:e.currTag,search:e.currSearch}),this.getMovies({page:1,tag:e.currTag,search:e.currSearch})]).then(function(){t.setState({loading:!1})})}},{key:"onDetailClose",value:function(){this.setState({detailVisible:!1})}},{key:"getMovies",value:function(e){var t=this,a=e.page,n=e.tag,r=e.search;return Object(j.a)({page:a,tag:n,search:r}).then(function(e){var a=e.data,n=a.code,r=a.body;1===n&&t.setState({movieList:r})})}},{key:"getMovieCount",value:function(e){var t=this,a=e.tag,n=e.search;return Object(j.d)({tag:a,search:n}).then(function(e){var a=e.data,n=a.code,r=a.body;1===n&&t.setState({totalCount:r})})}},{key:"openMovieDetail",value:function(e){this.setState({currDetailItem:e,detailVisible:!0})}},{key:"handlePageChange",value:function(e){var t=this;this.setState({currPage:e,loading:!0}),this.getMovies({page:e,tag:this.props.currTag,search:this.props.currSearch}).then(function(){t.setState({loading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.movieList,n=t.totalCount,r=t.detailVisible,s=t.currDetailItem,i=null,o=null;return t.loading&&(i=N.a.createElement("div",{className:"loading-wrap"},N.a.createElement(x.a,null))),r&&(o=N.a.createElement(F,{item:s,visible:r,onDetailClose:this.onDetailClose})),N.a.createElement("div",{className:"movie-list-wrap"},i,a.map(function(t){return N.a.createElement(P.a,{className:"movie-item-card",hoverable:!0,style:{width:240},key:t._id,cover:N.a.createElement("img",{src:t.coverImg,onClick:e.openMovieDetail.bind(e,t)})},N.a.createElement(V,{onClick:e.openMovieDetail.bind(e,t),title:t.title,description:"豆瓣评分："+(t.doubanScore.toFixed(1)||"无")}),N.a.createElement("p",{className:"categories"},"分类："+(t.tags?t.tags.join(","):"无")))}),N.a.createElement(k.a,{className:"movie-pagination-wrap",current:this.state.currPage,total:n,onChange:this.handlePageChange}),o)}}]),t}(N.a.Component),H=(a("Y5d4"),a("N1ly")),G=a.n(H),q=(a("g6Qm"),function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.state={tagList:[]},a}return g()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this;Object(j.b)().then(function(t){var a=t.data,n=a.code,r=a.body;r.sort(function(e,t){return e.name.length-t.name.length}),1===n&&e.setState({tagList:r})})}},{key:"render",value:function(){var e=this,t=this.state.tagList;return N.a.createElement("div",{className:"tag-list-wrap"},t.filter(function(e){return e.name.length<=5}).map(function(t){return N.a.createElement(G.a,{className:{active:e.props.currTag.split(",").indexOf(t.name)>=0},key:t.name,onClick:function(){e.props.onTagSelected(t.name)}},t.name)}))}}]),t}(N.a.PureComponent)),B=(a("alKx"),a("mIgp")),A=a.n(B),R=(a("+yd9"),a("cA4L")),z=a.n(R),K=(a("IgLz"),a("cvLx")),W=a.n(K),Q=(a("wduS"),a("TDd1")),J=a.n(Q),Z=(a("u649"),a("P/Ll")),$=a.n(Z),X=(a("VUWf"),a("Y526")),Y=a.n(X),ee=a("N+L8");a("0Irh");var te=function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.state={loading:!1,captchaPass:!1},a}return g()(t,e),p()(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){if(!e){var n=a.userName,r=a.password,s=a.remember,i=a.captcha;t.setState({loading:!0}),Object(j.f)({userName:n}).then(function(e){var a=e.data,o=a.code,c=a.msg,l=a.data;if(1===o){var u=l.salt,m=Object(ee.a)(r,u).hash;Object(j.i)({userName:n,hash:m,remember:s,captcha:i}).then(function(e){var a=e.data,r=a.code,s=a.msg;1===r?(W.a.success(n+"，欢迎肥来"),t.props.onLoginSuccess()):(W.a.error(s),t.setState({captchaPass:!1})),t.setState({loading:!1})}).catch(function(e){W.a.error("网络错误，请稍后再试！"),t.setState({loading:!1,captchaPass:!1})})}else W.a.error(c),t.setState({loading:!1})}).catch(function(e){W.a.error("网络错误，请稍后再试！"),t.setState({loading:!1})})}})}},{key:"onCaptchaSuccess",value:function(e){0===e.ret&&(this.props.form.setFieldsValue({captcha:e}),this.setState({captchaPass:!0}))}},{key:"componentDidMount",value:function(){var e=document.getElementById("normal_login_captcha");e&&new TencentCaptcha(e,2039369087,this.onCaptchaSuccess.bind(this))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.onChangeForm,a=this.state,n=a.loading,r=a.captchaPass,s=N.a.createElement(Y.a,{className:"ant-input-affix-wrapper",type:"primary",ghost:!0},N.a.createElement(z.a,{type:"safety-certificate"}),"点击验证");r&&(s=N.a.createElement(Y.a,{className:"ant-input-affix-wrapper",disabled:!0,ghost:!0},N.a.createElement(z.a,{type:"check"}),"验证通过"));var i=N.a.createElement(Y.a,{type:"primary",htmlType:"submit",className:"login-form-button",onClick:this.handleSubmit.bind(this)},"登录");return n&&(i=N.a.createElement(Y.a,{type:"primary",disabled:!0,className:"login-form-button"},N.a.createElement(z.a,{type:"loading"}))),N.a.createElement($.a,{className:"user-login-form"},N.a.createElement($.a.Item,null,e("userName",{rules:[{required:!0,message:"请输入用户名！"}]})(N.a.createElement(E.a,{prefix:N.a.createElement(z.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"用户名"}))),N.a.createElement($.a.Item,null,e("password",{rules:[{required:!0,message:"请输入密码！"}]})(N.a.createElement(E.a,{prefix:N.a.createElement(z.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"密码"}))),N.a.createElement($.a.Item,null,e("captcha",{initialValue:"",rules:[{required:!0,message:"请完成验证！"}]})(s)),N.a.createElement($.a.Item,null,e("remember",{valuePropName:"checked",initialValue:!0})(N.a.createElement(J.a,null,"记住本次登录")),N.a.createElement("a",{className:"login-form-forgot",href:""},"忘记密码？"),i,"Or ",N.a.createElement("a",{onClick:function(){t("signUp")},href:"javascript: void 0;"},"立即注册")))}}]),t}(N.a.Component),ae=$.a.create({name:"normal_login"})(te),ne=(a("Zgbf"),function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.state={confirmDirty:!1,autoCompleteResult:[],loading:!1,captchaPass:!1},a}return g()(t,e),p()(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,a){if(!e){var n=a.userName,r=a.password,s=Object(ee.a)(r),i=s.salt,o=s.hash;t.setState({loading:!0}),Object(j.j)({userName:n,salt:i,hash:o}).then(function(e){var a=e.data,s=a.code,i=a.msg;1===s?(W.a.success(i),t.props.onSignUp({userName:n,password:r})):(W.a.error(i),t.setState({captchaPass:!1})),t.setState({loading:!1})}).catch(function(e){W.a.error("网络错误，请稍后再试！"),t.setState({captchaPass:!1,loading:!1})})}})}},{key:"handleConfirmBlur",value:function(e){var t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})}},{key:"compareToFirstPassword",value:function(e,t,a){var n=this.props.form;t&&t!==n.getFieldValue("password")?a("两次输入密码不一致！"):a()}},{key:"validateToNextPassword",value:function(e,t,a){var n=this.props.form;t&&this.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),a()}},{key:"onCaptchaSuccess",value:function(e){0===e.ret&&(this.props.form.setFieldsValue({captcha:e}),this.setState({captchaPass:!0}))}},{key:"componentDidMount",value:function(){var e=document.getElementById("register_captcha");e&&new TencentCaptcha(e,2039369087,this.onCaptchaSuccess.bind(this))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props.onChangeForm,a=this.state,n=a.loading,s=a.captchaPass,i=N.a.createElement(Y.a,{className:"ant-input-affix-wrapper",type:"primary",ghost:!0},N.a.createElement(z.a,{type:"safety-certificate"}),"点击验证");s&&(i=N.a.createElement(Y.a,{className:"ant-input-affix-wrapper",disabled:!0,ghost:!0},N.a.createElement(z.a,{type:"check"}),"验证通过"));var o=N.a.createElement(Y.a,{type:"primary",htmlType:"submit"},"注册");n&&(o=N.a.createElement(Y.a,{type:"primary",htmlType:"submit",disabled:!0},N.a.createElement(z.a,{type:"loading"})));var c={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}};return N.a.createElement($.a,{onSubmit:this.handleSubmit.bind(this),className:"user-sign-up-wrap"},N.a.createElement($.a.Item,r()({},c,{label:"用户名"}),e("userName",{rules:[{pattern:/^\w+$/g,message:"用户名只能包含字母、数字、下划线！"},{required:!0,message:"请输入用户名！"},{min:5,message:"用户名至少5位！"},{max:12,message:"用户名最多12位！"}]})(N.a.createElement(E.a,{prefix:N.a.createElement(z.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}})}))),N.a.createElement($.a.Item,r()({},c,{label:"密码"}),e("password",{rules:[{required:!0,min:6,message:"请输入至少6位的密码！"},{validator:this.validateToNextPassword.bind(this)}]})(N.a.createElement(E.a,{prefix:N.a.createElement(z.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password"}))),N.a.createElement($.a.Item,r()({},c,{label:"确认密码"}),e("confirm",{rules:[{required:!0,message:"请确认密码！"},{validator:this.compareToFirstPassword.bind(this)}]})(N.a.createElement(E.a,{prefix:N.a.createElement(z.a,{type:"copy",style:{color:"rgba(0,0,0,.25)"}}),type:"password",onBlur:this.handleConfirmBlur.bind(this)}))),N.a.createElement($.a.Item,r()({},c,{label:"人机验证"}),e("captcha",{initialValue:"",rules:[{required:!0,message:"请完成验证！"}]})(i)),N.a.createElement($.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:18,offset:6}}},o,N.a.createElement("a",{className:"btn-login",href:"javascript: void 0;",onClick:function(){t("login")}},"已有账号，立即登录")))}}]),t}(N.a.Component)),re=$.a.create({name:"register"})(ne),se=(a("ftVz"),window.location.origin+"/kmovies/");var ie=function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.state={showForm:"login"},a}return g()(t,e),p()(t,[{key:"changeForm",value:function(e){this.setState({showForm:e})}},{key:"onSignUp",value:function(e){this.changeForm("login")}},{key:"render",value:function(){var e=this.state.showForm,t=N.a.createElement("div",{className:"user-login-modal"});return"login"===e&&(t=N.a.createElement("div",{className:"user-login-modal"},N.a.createElement(ae,{onChangeForm:this.changeForm.bind(this),onLoginSuccess:this.props.onLoginSuccess}),N.a.createElement(i.a,null,"其他方式登录"),N.a.createElement("div",{className:"user-login-channel-wrap"},N.a.createElement("a",{className:"btn-login",href:"https://github.com/login/oauth/authorize?client_id=3603eea13d61bfaca9ee&redirect_uri="+se+"github.html"},N.a.createElement(z.a,{type:"github",theme:"filled"}),N.a.createElement("span",null,"GitHub"))))),"signUp"===e&&(t=N.a.createElement("div",{className:"user-login-modal"},N.a.createElement(re,{onChangeForm:this.changeForm.bind(this),onSignUp:this.onSignUp.bind(this)}))),t}}]),t}(N.a.Component),oe=(a("C4rp"),function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.getUserInfo(),a.state={loading:!0,userInfo:null,userInfoGitHub:null,modalVisible:!1},a}return g()(t,e),p()(t,[{key:"onLoginSuccess",value:function(){this.setModalVisible(!1),this.getUserInfo()}},{key:"logOut",value:function(){this.setState(r()({},this.state,{loading:!0})),Object(j.h)().then(function(e){e.data.code>0?window.location.reload():W.a.error(e.data.msg)}).catch(function(e){W.a.error("哦豁，登出失败")})}},{key:"setModalVisible",value:function(e){this.setState({modalVisible:e})}},{key:"getUserInfo",value:function(){var e=this;Object(j.e)().then(function(t){t.data.code>0?e.setState({userInfo:t.data.userInfo,userInfoGitHub:t.data.userInfoGitHub,loading:!1}):e.setState({userInfo:null,userInfoGitHub:null,loading:!1})}).catch(function(t){e.setState({userInfo:null,userInfoGitHub:null,loading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.userInfo,r=t.userInfoGitHub,s=t.loading,i=N.a.createElement("div",{className:"btn-login",onClick:this.setModalVisible.bind(this,!0)},"登录/注册");return s?i=N.a.createElement(z.a,{type:"loading"}):n?i=N.a.createElement("div",null,N.a.createElement("div",{className:"userInfo-wrap"},N.a.createElement("div",{className:"user-avatar",style:{backgroundImage:"url("+a("Sy0d")+")"}}),N.a.createElement("div",{className:"username"},N.a.createElement(z.a,{type:"user"}),n.userName)),N.a.createElement("a",{className:"btn-logout",href:"javascript: void 0;",onClick:this.logOut.bind(this)},N.a.createElement(z.a,{type:"export"}),"登出")):r&&(i=N.a.createElement("div",null,N.a.createElement("a",{className:"userInfo-wrap",href:r.html_url},N.a.createElement("div",{className:"user-avatar",style:{backgroundImage:"url('"+r.avatar_url+"')"}}),N.a.createElement("div",{className:"username"},N.a.createElement(z.a,{type:"user"}),r.login)),N.a.createElement("a",{className:"btn-logout",href:"javascript: void 0;",onClick:this.logOut.bind(this)},N.a.createElement(z.a,{type:"export"}),"登出"))),N.a.createElement("div",{className:"user-login-wrap"},i,N.a.createElement(A.a,{title:"登录/注册",centered:!0,footer:null,visible:this.state.modalVisible,onOk:function(){return e.setModalVisible(!1)},onCancel:function(){return e.setModalVisible(!1)}},N.a.createElement(ie,{onLoginSuccess:this.onLoginSuccess.bind(this)})))}}]),t}(N.a.Component)),ce=E.a.Search,le=b.a.Header,ue=b.a.Footer,me=b.a.Sider,pe=b.a.Content,he=function(e){function t(e){u()(this,t);var a=d()(this,(t.__proto__||c()(t)).call(this,e));return a.onTagSelected=a.onTagSelected.bind(a),a.onSearch=a.onSearch.bind(a),a.state={currTag:"",currSearch:""},a}return g()(t,e),p()(t,[{key:"shouldComponentUpdate",value:function(e,t){return t.currTag!==this.state.currTag||t.currSearch!==this.state.currSearch}},{key:"onSearch",value:function(e){this.setState({currSearch:e})}},{key:"onTagSelected",value:function(e){if(!this.state.currTag)return this.setState({currTag:e});var t=this.state.currTag.split(",").indexOf(e);t>=0?this.setState({currTag:this.state.currTag.split(",").slice(0,t).concat(this.state.currTag.split(",").slice(t+1)).join(",")}):this.setState({currTag:this.state.currTag.split(",").concat([e]).join(",")})}},{key:"render",value:function(){return N.a.createElement(b.a,null,N.a.createElement(le,{className:"app-header"},N.a.createElement("h1",null,"KMovies"),N.a.createElement(oe,null)),N.a.createElement(b.a,null,N.a.createElement(me,{className:"app-side-bar"},N.a.createElement(i.a,null,"搜索"),N.a.createElement(ce,{placeholder:"输入电影标题",onSearch:this.onSearch,enterButton:!0}),N.a.createElement(i.a,null,"标签"),N.a.createElement(q,r()({},this.state,{onTagSelected:this.onTagSelected}))),N.a.createElement(pe,null,N.a.createElement(U,this.state))),N.a.createElement(ue,{className:"app-footer"},"Crafted By MAIUXI.CHA @2018"))}}]),t}(N.a.Component),de=a("jCnN");a.n(de).a.render(N.a.createElement(he,null),document.querySelector("#app"))},Zgbf:function(e,t,a){},ftVz:function(e,t,a){},g6Qm:function(e,t,a){},mmHs:function(e,t,a){},"nF/r":function(e,t,a){}});