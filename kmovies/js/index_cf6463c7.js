!function(e){function t(t){for(var r,o,c=t[0],s=t[1],u=t[2],h=0,p=[];h<c.length;h++)o=c[h],n[o]&&p.push(n[o][0]),n[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,c=1;c<a.length;c++){var s=a[c];0!==n[s]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={0:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/kmovies/";var c=window.leihuoJsonp=window.leihuoJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;i.push(["0imc",1]),a()}({"0imc":function(e,t,a){a("nF/r"),a("UxGy")},UxGy:function(e,t,a){"use strict";a.r(t);var r=a("aCiN"),n=a.n(r),i=(a("CwFX"),a("ZHqZ")),o=a.n(i),c=a("FIqa"),s=a.n(c),u=a("QNlA"),l=a.n(u),h=a("A9H1"),p=a.n(h),g=a("QZQY"),d=a.n(g),f=a("DEPL"),m=a.n(f),v=(a("jg/r"),a("DV1s")),y=a.n(v),S=(a("XpWd"),a("ZYlS")),b=a.n(S),T=a("yFrV"),k=a.n(T),w=(a("zKdU"),a("dkWT")),C=a.n(w),E=(a("tTz0"),a("mtzS")),_=a.n(E),M=(a("Voge"),a("uU96")),P=a.n(M),x=(a("mmHs"),a("NeUJ")),L=a.n(x),N=a("ygJK"),j=a.n(N),O=a("oxLo");var D,U,F,V=a.n(O).a.create({baseURL:"http://35.234.3.252:3000",withCredentials:!0}),H=(D=j()(L.a.mark(function e(t){var a=t.page,r=t.tag,n=t.search;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("/movies",{params:{page:a,tag:r,search:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return D.apply(this,arguments)}),Q=(U=j()(L.a.mark(function e(t){var a=t.tag,r=t.search;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("/totalcount",{params:{tag:a,search:r}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return U.apply(this,arguments)}),z=(F=j()(L.a.mark(function e(){return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("/taglist");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return F.apply(this,arguments)}),A=P.a.Meta,I=function(e){function t(e){l()(this,t);var a=d()(this,(t.__proto__||s()(t)).call(this,e));return a.handlePageChange=a.handlePageChange.bind(a),a.state={movieList:[],totalCount:1,currPage:1,detailVisible:!1,currDownloadList:[]},a}return m()(t,e),p()(t,[{key:"componentDidMount",value:function(){this.getMovieCount({tag:this.props.currTag,search:this.props.currSearch}),this.getMovies({page:this.state.currPage,tag:this.props.currTag,search:this.props.currSearch})}},{key:"componentWillReceiveProps",value:function(e){this.setState({currPage:1}),this.getMovieCount({tag:e.currTag,search:e.currSearch}),this.getMovies({page:1,tag:e.currTag,search:e.currSearch})}},{key:"getMovies",value:function(e){var t=this,a=e.page,r=e.tag,n=e.search;H({page:a,tag:r,search:n}).then(function(e){var a=e.data,r=a.code,n=a.body;1===r&&t.setState({movieList:n})})}},{key:"getMovieCount",value:function(e){var t=this,a=e.tag,r=e.search;Q({tag:a,search:r}).then(function(e){var a=e.data,r=a.code,n=a.body;1===r&&t.setState({totalCount:n})})}},{key:"openMovieDetail",value:function(e){console.log("clicl"),this.setState({currDownloadList:e,detailVisible:!0})}},{key:"handlePageChange",value:function(e){this.setState({currPage:e}),this.getMovies({page:e,tag:this.props.currTag,search:this.props.currSearch})}},{key:"render",value:function(){var e=this,t=this.state,a=t.movieList,r=t.totalCount,n=t.detailVisible,i=t.currDownloadList;return k.a.createElement("div",{className:"movie-list-wrap"},a.map(function(t){return k.a.createElement(P.a,{className:"movie-item-card",hoverable:!0,style:{width:240},key:t._id,cover:k.a.createElement("img",{src:t.coverImg,onClick:e.openMovieDetail.bind(e,t.downloadList)})},k.a.createElement(A,{onClick:e.openMovieDetail.bind(e,t.downloadList),title:t.title,description:"豆瓣评分："+(t.doubanScore.toFixed(1)||"无")}),k.a.createElement("p",{className:"categories"},"分类："+(t.tags?t.tags.join(","):"无")))}),k.a.createElement(_.a,{className:"movie-pagination-wrap",current:this.state.currPage,total:r,onChange:this.handlePageChange}),k.a.createElement(C.a,{title:"影片资源",width:"800",placement:"right",onClose:function(){return e.setState({detailVisible:!1})},visible:n},i.map(function(e,t){return k.a.createElement("p",{className:"movie-download-item",key:t},k.a.createElement("a",{href:e.href,target:"_blank"},e.title))})))}}]),t}(k.a.Component),J=(a("jXyh"),a("zouS")),X=a.n(J),Z=(a("g6Qm"),function(e){function t(e){l()(this,t);var a=d()(this,(t.__proto__||s()(t)).call(this,e));return a.state={tagList:[]},a}return m()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this;z().then(function(t){var a=t.data,r=a.code,n=a.body;n.sort(function(e,t){return e.name.length-t.name.length}),1===r&&e.setState({tagList:n})})}},{key:"render",value:function(){var e=this,t=this.state.tagList;return k.a.createElement("div",{className:"tag-list-wrap"},t.filter(function(e){return e.name.length<=5}).map(function(t){return k.a.createElement(X.a,{className:{active:e.props.currTag.split(",").indexOf(t.name)>=0},key:t.name,onClick:function(){e.props.onTagSelected(t.name)}},t.name)}))}}]),t}(k.a.PureComponent)),q=b.a.Search,K=y.a.Header,W=y.a.Footer,B=y.a.Sider,G=y.a.Content,R=function(e){function t(e){l()(this,t);var a=d()(this,(t.__proto__||s()(t)).call(this,e));return a.onTagSelected=a.onTagSelected.bind(a),a.onSearch=a.onSearch.bind(a),a.state={currTag:"",currSearch:""},a}return m()(t,e),p()(t,[{key:"shouldComponentUpdate",value:function(e,t){return t.currTag!==this.state.currTag||t.currSearch!==this.state.currSearch}},{key:"onSearch",value:function(e){this.setState({currSearch:e})}},{key:"onTagSelected",value:function(e){if(!this.state.currTag)return this.setState({currTag:e});var t=this.state.currTag.split(",").indexOf(e);t>=0?this.setState({currTag:this.state.currTag.split(",").slice(0,t).concat(this.state.currTag.split(",").slice(t+1)).join(",")}):this.setState({currTag:this.state.currTag.split(",").concat([e]).join(",")})}},{key:"render",value:function(){return k.a.createElement(y.a,null,k.a.createElement(K,{className:"app-header"},k.a.createElement("h1",null,"KMovies")),k.a.createElement(y.a,null,k.a.createElement(B,{className:"app-side-bar"},k.a.createElement(o.a,null,"搜索"),k.a.createElement(q,{placeholder:"输入电影标题",onSearch:this.onSearch,enterButton:!0}),k.a.createElement(o.a,null,"标签"),k.a.createElement(Z,n()({},this.state,{onTagSelected:this.onTagSelected}))),k.a.createElement(G,null,k.a.createElement(I,this.state))),k.a.createElement(W,{className:"app-footer"},"Crafted By MAIUXI.CHA @2018"))}}]),t}(k.a.Component),Y=a("pNQk");a.n(Y).a.render(k.a.createElement(R,null),document.querySelector("#app"))},g6Qm:function(e,t,a){},mmHs:function(e,t,a){},"nF/r":function(e,t,a){}});