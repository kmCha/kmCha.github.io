!function(e){function t(t){for(var n,s,o=t[0],c=t[1],l=t[2],h=0,p=[];h<o.length;h++)s=o[h],r[s]&&p.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,o=1;o<a.length;o++){var c=a[o];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},r={0:0},i=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/kmovies/";var o=window.leihuoJsonp=window.leihuoJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push(["0imc",1]),a()}({"0imc":function(e,t,a){a("nF/r"),a("UxGy")},MvKN:function(e,t,a){},UxGy:function(e,t,a){"use strict";a.r(t);var n=a("aCiN"),r=a.n(n),i=(a("CwFX"),a("ZHqZ")),s=a.n(i),o=a("FIqa"),c=a.n(o),l=a("QNlA"),u=a.n(l),h=a("A9H1"),p=a.n(h),m=a("QZQY"),g=a.n(m),d=a("DEPL"),f=a.n(d),v=(a("jg/r"),a("DV1s")),S=a.n(v),y=(a("XpWd"),a("ZYlS")),E=a.n(y),b=a("yFrV"),N=a.n(b),C=(a("tTz0"),a("mtzS")),k=a.n(C),T=(a("S1d5"),a("j7Ql")),w=a.n(T),M=a("goh/"),_=a.n(M),P=(a("Voge"),a("uU96")),x=a.n(P),D=(a("mmHs"),a("NeUJ")),j=a.n(D),L=a("ygJK"),O=a.n(L),I=a("oxLo");var U,F,Q,V=a.n(I).a.create({baseURL:"http://148.70.52.4:3000",withCredentials:!0}),H=(U=O()(j.a.mark(function e(t){var a=t.page,n=t.tag,r=t.search;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("/movies",{params:{page:a,tag:n,search:r}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return U.apply(this,arguments)}),z=(F=O()(j.a.mark(function e(t){var a=t.tag,n=t.search;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("/totalcount",{params:{tag:a,search:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(e){return F.apply(this,arguments)}),K=(Q=O()(j.a.mark(function e(){return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("/taglist");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})),function(){return Q.apply(this,arguments)}),A=(a("zKdU"),a("dkWT")),J=a.n(A),W=(a("T71y"),a("zW/R")),X=a.n(W);a("MvKN");function Z(e){var t=e.item,a=e.onDetailClose,n=e.visible,r="暂无";t.doubanLink&&(r=N.a.createElement("a",{href:t.doubanLink,target:"_blank"},t.doubanLink));var i=null,s=null;return t.downloadList&&t.downloadList.length>0&&(i=N.a.createElement("div",{className:"info-title"},"种子："),s=t.downloadList.map(function(e,t){return N.a.createElement("p",{className:"movie-download-item",key:t},N.a.createElement("a",{href:e.href,target:"_blank"},e.title))})),N.a.createElement(J.a,{title:t.title,width:"800",placement:"right",onClose:a,visible:n},N.a.createElement("div",{className:"info-wrap"},N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"豆瓣评分："),N.a.createElement("span",{className:"content"},t.doubanScore,N.a.createElement(X.a,{disabled:!0,value:t.doubanScore/2}))),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"豆瓣链接："),N.a.createElement("span",{className:"content"},r)),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"上映日期："),N.a.createElement("span",{className:"content"},t.releaseDate)),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"大陆上映："),N.a.createElement("span",{className:"content"},t.releaseInChina?"是":"否")),N.a.createElement("div",{className:"info-group"},N.a.createElement("span",{className:"title"},"分类标签："),N.a.createElement("span",{className:"content"},(t.tags||[]).join(",")))),i,s)}var q=x.a.Meta,R=function(e){function t(e){u()(this,t);var a=g()(this,(t.__proto__||c()(t)).call(this,e));return a.handlePageChange=a.handlePageChange.bind(a),a.onDetailClose=a.onDetailClose.bind(a),a.state={movieList:[],totalCount:1,currPage:1,detailVisible:!1,currDetailItem:[],loading:!0},a}return f()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this;_.a.all([this.getMovieCount({tag:this.props.currTag,search:this.props.currSearch}),this.getMovies({page:this.state.currPage,tag:this.props.currTag,search:this.props.currSearch})]).then(function(){e.setState({loading:!1})})}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.setState({currPage:1,loading:!0}),_.a.all([this.getMovieCount({tag:e.currTag,search:e.currSearch}),this.getMovies({page:1,tag:e.currTag,search:e.currSearch})]).then(function(){t.setState({loading:!1})})}},{key:"onDetailClose",value:function(){this.setState({detailVisible:!1})}},{key:"getMovies",value:function(e){var t=this,a=e.page,n=e.tag,r=e.search;return H({page:a,tag:n,search:r}).then(function(e){var a=e.data,n=a.code,r=a.body;1===n&&t.setState({movieList:r})})}},{key:"getMovieCount",value:function(e){var t=this,a=e.tag,n=e.search;return z({tag:a,search:n}).then(function(e){var a=e.data,n=a.code,r=a.body;1===n&&t.setState({totalCount:r})})}},{key:"openMovieDetail",value:function(e){this.setState({currDetailItem:e,detailVisible:!0})}},{key:"handlePageChange",value:function(e){var t=this;this.setState({currPage:e,loading:!0}),this.getMovies({page:e,tag:this.props.currTag,search:this.props.currSearch}).then(function(){t.setState({loading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.movieList,n=t.totalCount,r=t.detailVisible,i=t.currDetailItem,s=null,o=null;return t.loading&&(s=N.a.createElement("div",{className:"loading-wrap"},N.a.createElement(w.a,null))),r&&(o=N.a.createElement(Z,{item:i,visible:r,onDetailClose:this.onDetailClose})),N.a.createElement("div",{className:"movie-list-wrap"},s,a.map(function(t){return N.a.createElement(x.a,{className:"movie-item-card",hoverable:!0,style:{width:240},key:t._id,cover:N.a.createElement("img",{src:t.coverImg,onClick:e.openMovieDetail.bind(e,t)})},N.a.createElement(q,{onClick:e.openMovieDetail.bind(e,t),title:t.title,description:"豆瓣评分："+(t.doubanScore.toFixed(1)||"无")}),N.a.createElement("p",{className:"categories"},"分类："+(t.tags?t.tags.join(","):"无")))}),N.a.createElement(k.a,{className:"movie-pagination-wrap",current:this.state.currPage,total:n,onChange:this.handlePageChange}),o)}}]),t}(N.a.Component),B=(a("jXyh"),a("zouS")),G=a.n(B),Y=(a("g6Qm"),function(e){function t(e){u()(this,t);var a=g()(this,(t.__proto__||c()(t)).call(this,e));return a.state={tagList:[]},a}return f()(t,e),p()(t,[{key:"componentDidMount",value:function(){var e=this;K().then(function(t){var a=t.data,n=a.code,r=a.body;r.sort(function(e,t){return e.name.length-t.name.length}),1===n&&e.setState({tagList:r})})}},{key:"render",value:function(){var e=this,t=this.state.tagList;return N.a.createElement("div",{className:"tag-list-wrap"},t.filter(function(e){return e.name.length<=5}).map(function(t){return N.a.createElement(G.a,{className:{active:e.props.currTag.split(",").indexOf(t.name)>=0},key:t.name,onClick:function(){e.props.onTagSelected(t.name)}},t.name)}))}}]),t}(N.a.PureComponent)),$=E.a.Search,ee=S.a.Header,te=S.a.Footer,ae=S.a.Sider,ne=S.a.Content,re=function(e){function t(e){u()(this,t);var a=g()(this,(t.__proto__||c()(t)).call(this,e));return a.onTagSelected=a.onTagSelected.bind(a),a.onSearch=a.onSearch.bind(a),a.state={currTag:"",currSearch:""},a}return f()(t,e),p()(t,[{key:"shouldComponentUpdate",value:function(e,t){return t.currTag!==this.state.currTag||t.currSearch!==this.state.currSearch}},{key:"onSearch",value:function(e){this.setState({currSearch:e})}},{key:"onTagSelected",value:function(e){if(!this.state.currTag)return this.setState({currTag:e});var t=this.state.currTag.split(",").indexOf(e);t>=0?this.setState({currTag:this.state.currTag.split(",").slice(0,t).concat(this.state.currTag.split(",").slice(t+1)).join(",")}):this.setState({currTag:this.state.currTag.split(",").concat([e]).join(",")})}},{key:"render",value:function(){return N.a.createElement(S.a,null,N.a.createElement(ee,{className:"app-header"},N.a.createElement("h1",null,"KMovies")),N.a.createElement(S.a,null,N.a.createElement(ae,{className:"app-side-bar"},N.a.createElement(s.a,null,"搜索"),N.a.createElement($,{placeholder:"输入电影标题",onSearch:this.onSearch,enterButton:!0}),N.a.createElement(s.a,null,"标签"),N.a.createElement(Y,r()({},this.state,{onTagSelected:this.onTagSelected}))),N.a.createElement(ne,null,N.a.createElement(R,this.state))),N.a.createElement(te,{className:"app-footer"},"Crafted By MAIUXI.CHA @2018"))}}]),t}(N.a.Component),ie=a("pNQk");a.n(ie).a.render(N.a.createElement(re,null),document.querySelector("#app"))},g6Qm:function(e,t,a){},mmHs:function(e,t,a){},"nF/r":function(e,t,a){}});